package tg_service

import (
	"bytes"
	"encoding/json"
	"fmt"
	"myapp/internal/models"
	"myapp/internal/repository/pg"
	"myapp/pkg/logger"
	"myapp/pkg/my_time_parser"
	"net/http"
	"time"

	"github.com/go-co-op/gocron"
)

var (
	mskLoc, _ = time.LoadLocation("Europe/Moscow")
)


var (
	stepsMap = map[string][]string{
		"-1": {"üè¶‚Å£  üí∞üí∞üí∞üëà", "üè¶‚Å£ üí∞üí∞üí∞üëà", "üè¶‚Å£üí∞üí∞üí∞üëà", "üè¶‚Å£üí∞üí∞üëà", "üè¶‚Å£üí∞üëà", "üè¶‚Å£üëà", "delete"},

		"1": {
			"–Ø –ø—Ä–µ–¥–ª–∞–≥–∞—é —Ç–µ–±–µ —Å—ã–≥—Ä–∞—Ç—å —Å–æ –º–Ω–æ–π –≤ –∏–≥—Ä—É,",
			"–Ø –ø—Ä–µ–¥–ª–∞–≥–∞—é —Ç–µ–±–µ —Å—ã–≥—Ä–∞—Ç—å —Å–æ –º–Ω–æ–π –≤ –∏–≥—Ä—É, –≥–¥–µ —Ç—ã –±—É–¥–µ—à—å –ø–æ–ª—É—á–∞—Ç—å –¥–µ–Ω—å–≥–∏ –∑–∞ –∫–∞–∂–¥–æ–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ üí∏",
			"–Ø –ø—Ä–µ–¥–ª–∞–≥–∞—é —Ç–µ–±–µ —Å—ã–≥—Ä–∞—Ç—å —Å–æ –º–Ω–æ–π –≤ –∏–≥—Ä—É, –≥–¥–µ —Ç—ã –±—É–¥–µ—à—å –ø–æ–ª—É—á–∞—Ç—å –¥–µ–Ω—å–≥–∏ –∑–∞ –∫–∞–∂–¥–æ–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ üí∏\n\n–ï—Å–ª–∏ –ø—Ä–æ–π–¥–µ—à—å –∏–≥—Ä—É –¥–æ –∫–æ–Ω—Ü–∞, <b>—Ç–æ —Å–º–æ–∂–µ—à—å –≤—ã–∏–≥—Ä–∞—Ç—å 100.000 —Ä—É–±–ª–µ–π üò≥</b>",
			"–Ø –ø—Ä–µ–¥–ª–∞–≥–∞—é —Ç–µ–±–µ —Å—ã–≥—Ä–∞—Ç—å —Å–æ –º–Ω–æ–π –≤ –∏–≥—Ä—É, –≥–¥–µ —Ç—ã –±—É–¥–µ—à—å –ø–æ–ª—É—á–∞—Ç—å –¥–µ–Ω—å–≥–∏ –∑–∞ –∫–∞–∂–¥–æ–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ üí∏\n\n–ï—Å–ª–∏ –ø—Ä–æ–π–¥–µ—à—å –∏–≥—Ä—É –¥–æ –∫–æ–Ω—Ü–∞, <b>—Ç–æ —Å–º–æ–∂–µ—à—å –≤—ã–∏–≥—Ä–∞—Ç—å 100.000 —Ä—É–±–ª–µ–π üò≥</b>\n–í—Å—è –∏–≥—Ä–∞ –Ω–µ –∑–∞–π–º—ë—Ç –±–æ–ª–µ–µ 15 –º–∏–Ω—É—Ç ‚åõÔ∏è",
		},
		"2": {
			"<b>–ö—Å—Ç–∞—Ç–∏, —É —Ç–µ–±—è –µ—Å—Ç—å 3 –∂–∏–∑–Ω–∏ ‚ù§Ô∏è</b>",
			"<b>–ö—Å—Ç–∞—Ç–∏, —É —Ç–µ–±—è –µ—Å—Ç—å 3 –∂–∏–∑–Ω–∏ ‚ù§Ô∏è</b>\n\nü•µ–ï—Å–ª–∏ —Ç—ã –¥–æ–ª–≥–æ –±–µ–∑–¥–µ–π—Å—Ç–≤—É–µ—à—å, —Ç–æ —Å–≥–æ—Ä–∞–µ—Ç –æ–¥–Ω–∞ –∂–∏–∑–Ω—å.",
			"<b>–ö—Å—Ç–∞—Ç–∏, —É —Ç–µ–±—è –µ—Å—Ç—å 3 –∂–∏–∑–Ω–∏ ‚ù§Ô∏è</b>\n\nü•µ–ï—Å–ª–∏ —Ç—ã –¥–æ–ª–≥–æ –±–µ–∑–¥–µ–π—Å—Ç–≤—É–µ—à—å, —Ç–æ —Å–≥–æ—Ä–∞–µ—Ç –æ–¥–Ω–∞ –∂–∏–∑–Ω—å.\nüòî–ö–æ–≥–¥–∞ —Å–≥–æ—Ä–∞—é—Ç –≤—Å–µ 3 –∂–∏–∑–Ω–∏, —Ç–≤–æ–π –±–∞–ª–∞–Ω—Å –æ–±–Ω—É–ª—è–µ—Ç—Å—è –∏ —Ç—ã –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—à—å —ç—Ç—É –∏–≥—Ä—É",
			"<b>–ö—Å—Ç–∞—Ç–∏, —É —Ç–µ–±—è –µ—Å—Ç—å 3 –∂–∏–∑–Ω–∏ ‚ù§Ô∏è</b>\n\nü•µ–ï—Å–ª–∏ —Ç—ã –¥–æ–ª–≥–æ –±–µ–∑–¥–µ–π—Å—Ç–≤—É–µ—à—å, —Ç–æ —Å–≥–æ—Ä–∞–µ—Ç –æ–¥–Ω–∞ –∂–∏–∑–Ω—å.\nüòî–ö–æ–≥–¥–∞ —Å–≥–æ—Ä–∞—é—Ç –≤—Å–µ 3 –∂–∏–∑–Ω–∏, —Ç–≤–æ–π –±–∞–ª–∞–Ω—Å –æ–±–Ω—É–ª—è–µ—Ç—Å—è –∏ —Ç—ã –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—à—å —ç—Ç—É –∏–≥—Ä—É\n\n–£ —Ç–µ–±—è –±—É–¥–µ—Ç –Ω–µ–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –≤—Å—ë –∑–∞–Ω–æ–≤–æ,",
			"<b>–ö—Å—Ç–∞—Ç–∏, —É —Ç–µ–±—è –µ—Å—Ç—å 3 –∂–∏–∑–Ω–∏ ‚ù§Ô∏è</b>\n\nü•µ–ï—Å–ª–∏ —Ç—ã –¥–æ–ª–≥–æ –±–µ–∑–¥–µ–π—Å—Ç–≤—É–µ—à—å, —Ç–æ —Å–≥–æ—Ä–∞–µ—Ç –æ–¥–Ω–∞ –∂–∏–∑–Ω—å.\nüòî–ö–æ–≥–¥–∞ —Å–≥–æ—Ä–∞—é—Ç –≤—Å–µ 3 –∂–∏–∑–Ω–∏, —Ç–≤–æ–π –±–∞–ª–∞–Ω—Å –æ–±–Ω—É–ª—è–µ—Ç—Å—è –∏ —Ç—ã –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—à—å —ç—Ç—É –∏–≥—Ä—É\n\n–£ —Ç–µ–±—è –±—É–¥–µ—Ç –Ω–µ–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –≤—Å—ë –∑–∞–Ω–æ–≤–æ, –Ω–æ –ª—É—á—à–µ –ø—Ä–æ–π–¥–∏ –≤—Å—ë —Å –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏üèÜ",
			"<b>–ö—Å—Ç–∞—Ç–∏, —É —Ç–µ–±—è –µ—Å—Ç—å 3 –∂–∏–∑–Ω–∏ ‚ù§Ô∏è</b>\n\nü•µ–ï—Å–ª–∏ —Ç—ã –¥–æ–ª–≥–æ –±–µ–∑–¥–µ–π—Å—Ç–≤—É–µ—à—å, —Ç–æ —Å–≥–æ—Ä–∞–µ—Ç –æ–¥–Ω–∞ –∂–∏–∑–Ω—å.\nüòî–ö–æ–≥–¥–∞ —Å–≥–æ—Ä–∞—é—Ç –≤—Å–µ 3 –∂–∏–∑–Ω–∏, —Ç–≤–æ–π –±–∞–ª–∞–Ω—Å –æ–±–Ω—É–ª—è–µ—Ç—Å—è –∏ —Ç—ã –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—à—å —ç—Ç—É –∏–≥—Ä—É\n\n–£ —Ç–µ–±—è –±—É–¥–µ—Ç –Ω–µ–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –≤—Å—ë –∑–∞–Ω–æ–≤–æ, –Ω–æ –ª—É—á—à–µ –ø—Ä–æ–π–¥–∏ –≤—Å—ë —Å –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏üèÜ\n\n–¢—ã –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ –∑–Ω–∞–µ—à—å, —á–µ–º –æ–±—ã—á–Ω–æ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è <i>‚Äú–æ—Ç–∫–ª–∞–¥—ã–≤–∞–Ω–∏–µ –≤ –¥–æ–ª–≥–∏–π —è—â–∏–∫‚Äùü™´</i>",
			"<b>–ö—Å—Ç–∞—Ç–∏, —É —Ç–µ–±—è –µ—Å—Ç—å 3 –∂–∏–∑–Ω–∏ ‚ù§Ô∏è</b>\n\nü•µ–ï—Å–ª–∏ —Ç—ã –¥–æ–ª–≥–æ –±–µ–∑–¥–µ–π—Å—Ç–≤—É–µ—à—å, —Ç–æ —Å–≥–æ—Ä–∞–µ—Ç –æ–¥–Ω–∞ –∂–∏–∑–Ω—å.\nüòî–ö–æ–≥–¥–∞ —Å–≥–æ—Ä–∞—é—Ç –≤—Å–µ 3 –∂–∏–∑–Ω–∏, —Ç–≤–æ–π –±–∞–ª–∞–Ω—Å –æ–±–Ω—É–ª—è–µ—Ç—Å—è –∏ —Ç—ã –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—à—å —ç—Ç—É –∏–≥—Ä—É\n\n–£ —Ç–µ–±—è –±—É–¥–µ—Ç –Ω–µ–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –≤—Å—ë –∑–∞–Ω–æ–≤–æ, –Ω–æ –ª—É—á—à–µ –ø—Ä–æ–π–¥–∏ –≤—Å—ë —Å –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏üèÜ\n\n–¢—ã –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ –∑–Ω–∞–µ—à—å, —á–µ–º –æ–±—ã—á–Ω–æ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è <i>‚Äú–æ—Ç–∫–ª–∞–¥—ã–≤–∞–Ω–∏–µ –≤ –¥–æ–ª–≥–∏–π —è—â–∏–∫‚Äùü™´</i>\n\n–ö–æ–≥–¥–∞ –≤—Ä–µ–º—è –≤—ã–π–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é - —É —Ç–µ–±—è –Ω–µ –±—É–¥–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å—ã–≥—Ä–∞—Ç—å,",
			"<b>–ö—Å—Ç–∞—Ç–∏, —É —Ç–µ–±—è –µ—Å—Ç—å 3 –∂–∏–∑–Ω–∏ ‚ù§Ô∏è</b>\n\nü•µ–ï—Å–ª–∏ —Ç—ã –¥–æ–ª–≥–æ –±–µ–∑–¥–µ–π—Å—Ç–≤—É–µ—à—å, —Ç–æ —Å–≥–æ—Ä–∞–µ—Ç –æ–¥–Ω–∞ –∂–∏–∑–Ω—å.\nüòî–ö–æ–≥–¥–∞ —Å–≥–æ—Ä–∞—é—Ç –≤—Å–µ 3 –∂–∏–∑–Ω–∏, —Ç–≤–æ–π –±–∞–ª–∞–Ω—Å –æ–±–Ω—É–ª—è–µ—Ç—Å—è –∏ —Ç—ã –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—à—å —ç—Ç—É –∏–≥—Ä—É\n\n–£ —Ç–µ–±—è –±—É–¥–µ—Ç –Ω–µ–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –≤—Å—ë –∑–∞–Ω–æ–≤–æ, –Ω–æ –ª—É—á—à–µ –ø—Ä–æ–π–¥–∏ –≤—Å—ë —Å –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏üèÜ\n\n–¢—ã –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ –∑–Ω–∞–µ—à—å, —á–µ–º –æ–±—ã—á–Ω–æ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è <i>‚Äú–æ—Ç–∫–ª–∞–¥—ã–≤–∞–Ω–∏–µ –≤ –¥–æ–ª–≥–∏–π —è—â–∏–∫‚Äùü™´</i>\n\n–ö–æ–≥–¥–∞ –≤—Ä–µ–º—è –≤—ã–π–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é - —É —Ç–µ–±—è –Ω–µ –±—É–¥–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å—ã–≥—Ä–∞—Ç—å, –¥–∞–∂–µ –µ—Å–ª–∏ —Ç—ã –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—à—å –±–æ—Ç–∞ ‚ò†Ô∏è",
		},
		"3": {
			"–ü–æ–∑–¥—Ä–∞–≤–ª—è—é!",
			"–ü–æ–∑–¥—Ä–∞–≤–ª—è—é!\n–í–∏–¥–∏—à—å, –∫–∞–∫ –≤—Å—ë –ø—Ä–æ—Å—Ç–æ üî•",
		},
		"4": {
			"–ê —Ç–µ–ø–µ—Ä—å –ø—Ä–µ–¥–ª–∞–≥–∞—é –ø–µ—Ä–µ–π—Ç–∏ —Å—Ä–∞–∑—É –∫ –º—è—Å—É ü•©",
		},
		"5": {
			"–û—Ç–≤–µ—Ç—å –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ 3 –≤–æ–ø—Ä–æ—Å–∞ –∏ –ø–æ–ª—É—á–∏—à—å +10.000‚ÇΩ –∫ –±–∞–Ω–∫—É! üí∏",
		},
		"6": {
			"–í–æ—É-–≤–æ—É-–≤–æ—É, –ø–∞–ª–µ—Ö—á–µ üòè",
			"–í–æ—É-–≤–æ—É-–≤–æ—É, –ø–∞–ª–µ—Ö—á–µ üòè\n\n+10.000‚ÇΩ —É—Ö–æ–¥—è—Ç –≤ —Ç–≤–æ–π –±–∞–Ω–∫ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã!üí∏",
		},
		"7": {
			"–ü–æ–∑–¥—Ä–∞–≤–ª—è—é!ü•≥",
			"–ü–æ–∑–¥—Ä–∞–≤–ª—è—é!ü•≥\n–î–æ —ç—Ç–æ–≥–æ —ç—Ç–∞–ø–∞ –¥–æ—Ö–æ–¥—è—Ç –≤—Å–µ–≥–æ –ª–∏—à—å 30% –∏–∑ –≤—Å–µ—Ö,",
			"–ü–æ–∑–¥—Ä–∞–≤–ª—è—é!ü•≥\n–î–æ —ç—Ç–æ–≥–æ —ç—Ç–∞–ø–∞ –¥–æ—Ö–æ–¥—è—Ç –≤—Å–µ–≥–æ –ª–∏—à—å 30% –∏–∑ –≤—Å–µ—Ö, –∫—Ç–æ –∑–∞–ø—É—Å—Ç–∏–ª –±–æ—Ç–∞!",
			"–ü–æ–∑–¥—Ä–∞–≤–ª—è—é!ü•≥\n–î–æ —ç—Ç–æ–≥–æ —ç—Ç–∞–ø–∞ –¥–æ—Ö–æ–¥—è—Ç –≤—Å–µ–≥–æ –ª–∏—à—å 30% –∏–∑ –≤—Å–µ—Ö, –∫—Ç–æ –∑–∞–ø—É—Å—Ç–∏–ª –±–æ—Ç–∞!\n–°–º–æ–∂–µ—à—å –ø—Ä–æ–π—Ç–∏ –¥–∞–ª—å—à–µ?ü§î",
			"–ü–æ–∑–¥—Ä–∞–≤–ª—è—é!ü•≥\n–î–æ —ç—Ç–æ–≥–æ —ç—Ç–∞–ø–∞ –¥–æ—Ö–æ–¥—è—Ç –≤—Å–µ–≥–æ –ª–∏—à—å 30% –∏–∑ –≤—Å–µ—Ö, –∫—Ç–æ –∑–∞–ø—É—Å—Ç–∏–ª –±–æ—Ç–∞!\n–°–º–æ–∂–µ—à—å –ø—Ä–æ–π—Ç–∏ –¥–∞–ª—å—à–µ?ü§î\n\n<b>–û—Ç–≤–µ—Ç—å –µ—â–µ –Ω–∞ 3 –≤–æ–ø—Ä–æ—Å–∞</b>, –Ω–æ —É—á—Ç–∏, –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–ª–æ–∂–Ω–µ–µ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö üòà",
			"–ü–æ–∑–¥—Ä–∞–≤–ª—è—é!ü•≥\n–î–æ —ç—Ç–æ–≥–æ —ç—Ç–∞–ø–∞ –¥–æ—Ö–æ–¥—è—Ç –≤—Å–µ–≥–æ –ª–∏—à—å 30% –∏–∑ –≤—Å–µ—Ö, –∫—Ç–æ –∑–∞–ø—É—Å—Ç–∏–ª –±–æ—Ç–∞!\n–°–º–æ–∂–µ—à—å –ø—Ä–æ–π—Ç–∏ –¥–∞–ª—å—à–µ?ü§î\n\n<b>–û—Ç–≤–µ—Ç—å –µ—â–µ –Ω–∞ 3 –≤–æ–ø—Ä–æ—Å–∞</b>, –Ω–æ —É—á—Ç–∏, –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–ª–æ–∂–Ω–µ–µ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö üòà\n\n–ü–æ–±–µ–¥–∏—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç +19.000‚ÇΩ –∫ –±–∞–Ω–∫—É! üí∏",
		},
		"8": {
			"+19.000‚ÇΩ —É—Ö–æ–¥—è—Ç –≤ —Ç–≤–æ–π –±–∞–Ω–∫ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ãüí∏",
			"+19.000‚ÇΩ —É—Ö–æ–¥—è—Ç –≤ —Ç–≤–æ–π –±–∞–Ω–∫ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ãüí∏\n\nüîê–ß—Ç–æ–±—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É –ø—Ä–∏—à–ª–∏ –º–Ω–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –∏–∑ —Ç–µ–∫—Å—Ç–∞ –Ω–∏–∂–µ:\n\n<a href=\"https://telegra.ph/KTO-HOCHET-STAT-MILLIONEROM-11-27\">üëâüèº„Ää–ß–ò–¢–ê–¢–¨„Äãüëàüèº</a>",
			"+19.000‚ÇΩ —É—Ö–æ–¥—è—Ç –≤ —Ç–≤–æ–π –±–∞–Ω–∫ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ãüí∏\n\nüîê–ß—Ç–æ–±—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É –ø—Ä–∏—à–ª–∏ –º–Ω–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –∏–∑ —Ç–µ–∫—Å—Ç–∞ –Ω–∏–∂–µ:\n\n<a href=\"https://telegra.ph/KTO-HOCHET-STAT-MILLIONEROM-11-27\">üëâüèº„Ää–ß–ò–¢–ê–¢–¨„Äãüëàüèº</a>\n\n*–ü—Ä–æ—á—Ç–µ–Ω–∏–µ –∑–∞–π–º—ë—Ç –Ω–µ –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç.",
			"+19.000‚ÇΩ —É—Ö–æ–¥—è—Ç –≤ —Ç–≤–æ–π –±–∞–Ω–∫ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ãüí∏\n\nüîê–ß—Ç–æ–±—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É –ø—Ä–∏—à–ª–∏ –º–Ω–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –∏–∑ —Ç–µ–∫—Å—Ç–∞ –Ω–∏–∂–µ:\n\n<a href=\"https://telegra.ph/KTO-HOCHET-STAT-MILLIONEROM-11-27\">üëâüèº„Ää–ß–ò–¢–ê–¢–¨„Äãüëàüèº</a>\n\n*–ü—Ä–æ—á—Ç–µ–Ω–∏–µ –∑–∞–π–º—ë—Ç –Ω–µ –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç. –ü–æ—Å–ª–µ –ø–∏—à–∏ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ —Å—é–¥–∞.\n–ë—É–¥—É –∂–¥–∞—Ç—å üëáüèª",
		},
		"9": {
			"–Ø —Å–º–æ—Ç—Ä—é —Ç—ã —Å–µ—Ä—å–µ–∑–Ω—ã–π –∏–≥—Ä–æ–∫!",
			"–Ø —Å–º–æ—Ç—Ä—é —Ç—ã —Å–µ—Ä—å–µ–∑–Ω—ã–π –∏–≥—Ä–æ–∫!\n–ü–æ—ç—Ç–æ–º—É –ø–æ–≤—ã—à–∞—é —Å—Ç–∞–≤–∫–∏ üîù",
		},
		"10": {
			"+25.000‚ÇΩ —É—Ö–æ–¥—è—Ç –≤ —Ç–≤–æ–π –±–∞–Ω–∫ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã! üí∏",
			"+25.000‚ÇΩ —É—Ö–æ–¥—è—Ç –≤ —Ç–≤–æ–π –±–∞–Ω–∫ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã! üí∏\n\nüîê–ß—Ç–æ–±—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É –ø—Ä–∏—à–ª–∏ –º–Ω–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –∏–∑ —Ç–µ–∫—Å—Ç–∞ –Ω–∏–∂–µ:\n\n<a href=\"https://telegra.ph/Rezultaty-i-dokazatelstva-11-27\">üëâüèº„Ää–ß–ò–¢–ê–¢–¨„Äãüëàüèº</a>",
			"+25.000‚ÇΩ —É—Ö–æ–¥—è—Ç –≤ —Ç–≤–æ–π –±–∞–Ω–∫ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã! üí∏\n\nüîê–ß—Ç–æ–±—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É –ø—Ä–∏—à–ª–∏ –º–Ω–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –∏–∑ —Ç–µ–∫—Å—Ç–∞ –Ω–∏–∂–µ:\n\n<a href=\"https://telegra.ph/Rezultaty-i-dokazatelstva-11-27\">üëâüèº„Ää–ß–ò–¢–ê–¢–¨„Äãüëàüèº</a>\n\n*–ü—Ä–æ—á—Ç–µ–Ω–∏–µ –∑–∞–π–º—ë—Ç –Ω–µ –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç.",
			"+25.000‚ÇΩ —É—Ö–æ–¥—è—Ç –≤ —Ç–≤–æ–π –±–∞–Ω–∫ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã! üí∏\n\nüîê–ß—Ç–æ–±—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É –ø—Ä–∏—à–ª–∏ –º–Ω–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –∏–∑ —Ç–µ–∫—Å—Ç–∞ –Ω–∏–∂–µ:\n\n<a href=\"https://telegra.ph/Rezultaty-i-dokazatelstva-11-27\">üëâüèº„Ää–ß–ò–¢–ê–¢–¨„Äãüëàüèº</a>\n\n*–ü—Ä–æ—á—Ç–µ–Ω–∏–µ –∑–∞–π–º—ë—Ç –Ω–µ –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç.\n–ü–æ—Å–ª–µ –ø–∏—à–∏ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ —Å—é–¥–∞.\n–ë—É–¥—É –∂–¥–∞—Ç—å üëáüèª",
		},
		"11": {
			"<b>–¢—ã –Ω–∞ –∑–∞–≤–µ—Ä—à–∞—é—â–µ–º —ç—Ç–∞–ø–µ –∏–≥—Ä—ãüèÅ</b>",
			"<b>–¢—ã –Ω–∞ –∑–∞–≤–µ—Ä—à–∞—é—â–µ–º —ç—Ç–∞–ø–µ –∏–≥—Ä—ãüèÅ</b>\n\n–î–æ —ç—Ç–æ–≥–æ —ç—Ç–∞–ø–∞ –º–æ–≥—É—Ç –ø—Ä–æ–π—Ç–∏ —Ç–æ–ª—å–∫–æ 10% –∏–∑ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—É—Å—Ç–∏–ª–∏ –±–æ—Ç–∞. üò±",
			"<b>–¢—ã –Ω–∞ –∑–∞–≤–µ—Ä—à–∞—é—â–µ–º —ç—Ç–∞–ø–µ –∏–≥—Ä—ãüèÅ</b>\n\n–î–æ —ç—Ç–æ–≥–æ —ç—Ç–∞–ø–∞ –º–æ–≥—É—Ç –ø—Ä–æ–π—Ç–∏ —Ç–æ–ª—å–∫–æ 10% –∏–∑ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—É—Å—Ç–∏–ª–∏ –±–æ—Ç–∞. üò±\n\n–ü–æ—ç—Ç–æ–º—É –∏ —Å—Ç–∞–≤–∫–∏ –±—É–¥—É—Ç –∫–∞–∫ –Ω–∏–∫–æ–≥–¥–∞ –±–æ–ª—å—à–∏–º–∏üòè",
			"<b>–¢—ã –Ω–∞ –∑–∞–≤–µ—Ä—à–∞—é—â–µ–º —ç—Ç–∞–ø–µ –∏–≥—Ä—ãüèÅ</b>\n\n–î–æ —ç—Ç–æ–≥–æ —ç—Ç–∞–ø–∞ –º–æ–≥—É—Ç –ø—Ä–æ–π—Ç–∏ —Ç–æ–ª—å–∫–æ 10% –∏–∑ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—É—Å—Ç–∏–ª–∏ –±–æ—Ç–∞. üò±\n\n–ü–æ—ç—Ç–æ–º—É –∏ —Å—Ç–∞–≤–∫–∏ –±—É–¥—É—Ç –∫–∞–∫ –Ω–∏–∫–æ–≥–¥–∞ –±–æ–ª—å—à–∏–º–∏üòè\n\n–ü–æ–±–µ–¥–∏—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç +45.000‚ÇΩ –≤ —Å–≤–æ–π –±–∞–Ω–∫üí∏",
			"<b>–¢—ã –Ω–∞ –∑–∞–≤–µ—Ä—à–∞—é—â–µ–º —ç—Ç–∞–ø–µ –∏–≥—Ä—ãüèÅ</b>\n\n–î–æ —ç—Ç–æ–≥–æ —ç—Ç–∞–ø–∞ –º–æ–≥—É—Ç –ø—Ä–æ–π—Ç–∏ —Ç–æ–ª—å–∫–æ 10% –∏–∑ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—É—Å—Ç–∏–ª–∏ –±–æ—Ç–∞. üò±\n\n–ü–æ—ç—Ç–æ–º—É –∏ —Å—Ç–∞–≤–∫–∏ –±—É–¥—É—Ç –∫–∞–∫ –Ω–∏–∫–æ–≥–¥–∞ –±–æ–ª—å—à–∏–º–∏üòè\n\n–ü–æ–±–µ–¥–∏—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç +45.000‚ÇΩ –≤ —Å–≤–æ–π –±–∞–Ω–∫üí∏\n\n–í—Å—ë –ø—Ä–æ—Å—Ç–æ,",
			"<b>–¢—ã –Ω–∞ –∑–∞–≤–µ—Ä—à–∞—é—â–µ–º —ç—Ç–∞–ø–µ –∏–≥—Ä—ãüèÅ</b>\n\n–î–æ —ç—Ç–æ–≥–æ —ç—Ç–∞–ø–∞ –º–æ–≥—É—Ç –ø—Ä–æ–π—Ç–∏ —Ç–æ–ª—å–∫–æ 10% –∏–∑ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—É—Å—Ç–∏–ª–∏ –±–æ—Ç–∞. üò±\n\n–ü–æ—ç—Ç–æ–º—É –∏ —Å—Ç–∞–≤–∫–∏ –±—É–¥—É—Ç –∫–∞–∫ –Ω–∏–∫–æ–≥–¥–∞ –±–æ–ª—å—à–∏–º–∏üòè\n\n–ü–æ–±–µ–¥–∏—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç +45.000‚ÇΩ –≤ —Å–≤–æ–π –±–∞–Ω–∫üí∏\n\n–í—Å—ë –ø—Ä–æ—Å—Ç–æ, —Ç–µ–±—è –∂–¥—É—Ç —Ä–µ—à–∞—é—â–∏–µ 3 –≤–æ–ø—Ä–æ—Å–∞, –æ—Ç–≤–µ—Ç–∏–≤ –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã –Ω–∞–∫–æ–Ω–µ—Ü-—Ç–æ –ø—Ä–æ–π–¥–µ—à—å –∏–≥—Ä—É –∏ —Å–º–æ–∂–µ—à—å –∑–∞–±—Ä–∞—Ç—å —Å–≤–æ—é –Ω–∞–≥—Ä–∞–¥—É üòâ",
		},
		"12": {
			"+45.000‚ÇΩ —É—Ö–æ–¥—è—Ç –≤ —Ç–≤–æ–π –±–∞–Ω–∫ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã!üí∏",
			"+45.000‚ÇΩ —É—Ö–æ–¥—è—Ç –≤ —Ç–≤–æ–π –±–∞–Ω–∫ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã!üí∏\n\nüîê–ß—Ç–æ–±—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É –ø—Ä–∏—à–ª–∏ –º–Ω–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –∏–∑ —Ç–µ–∫—Å—Ç–∞ –Ω–∏–∂–µ:\n\n<a href=\"https://telegra.ph/Kak-ehto-mozhet-pomenyat-zhizn-lyubogo-cheloveka-11-27\">üëâüèº„Ää–ß–ò–¢–ê–¢–¨„Äãüëàüèº</a>",
			"+45.000‚ÇΩ —É—Ö–æ–¥—è—Ç –≤ —Ç–≤–æ–π –±–∞–Ω–∫ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã!üí∏\n\nüîê–ß—Ç–æ–±—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É –ø—Ä–∏—à–ª–∏ –º–Ω–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –∏–∑ —Ç–µ–∫—Å—Ç–∞ –Ω–∏–∂–µ:\n\n<a href=\"https://telegra.ph/Kak-ehto-mozhet-pomenyat-zhizn-lyubogo-cheloveka-11-27\">üëâüèº„Ää–ß–ò–¢–ê–¢–¨„Äãüëàüèº</a>\n\n*–ü—Ä–æ—á—Ç–µ–Ω–∏–µ –∑–∞–π–º—ë—Ç –Ω–µ –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç.",
			"+45.000‚ÇΩ —É—Ö–æ–¥—è—Ç –≤ —Ç–≤–æ–π –±–∞–Ω–∫ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã!üí∏\n\nüîê–ß—Ç–æ–±—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É –ø—Ä–∏—à–ª–∏ –º–Ω–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –∏–∑ —Ç–µ–∫—Å—Ç–∞ –Ω–∏–∂–µ:\n\n<a href=\"https://telegra.ph/Kak-ehto-mozhet-pomenyat-zhizn-lyubogo-cheloveka-11-27\">üëâüèº„Ää–ß–ò–¢–ê–¢–¨„Äãüëàüèº</a>\n\n*–ü—Ä–æ—á—Ç–µ–Ω–∏–µ –∑–∞–π–º—ë—Ç –Ω–µ –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç.",
			"+45.000‚ÇΩ —É—Ö–æ–¥—è—Ç –≤ —Ç–≤–æ–π –±–∞–Ω–∫ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã!üí∏\n\nüîê–ß—Ç–æ–±—ã —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É –ø—Ä–∏—à–ª–∏ –º–Ω–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ –∏–∑ —Ç–µ–∫—Å—Ç–∞ –Ω–∏–∂–µ:\n\n<a href=\"https://telegra.ph/Kak-ehto-mozhet-pomenyat-zhizn-lyubogo-cheloveka-11-27\">üëâüèº„Ää–ß–ò–¢–ê–¢–¨„Äãüëàüèº</a>\n\n*–ü—Ä–æ—á—Ç–µ–Ω–∏–µ –∑–∞–π–º—ë—Ç –Ω–µ –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç.\n–ü–æ—Å–ª–µ –ø–∏—à–∏ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ —Å—é–¥–∞.\n–ë—É–¥—É –∂–¥–∞—Ç—å üëáüèª",
		},
		"13": {
			"<b>–ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã –ø–æ–±–µ–¥–∏–ª üéâ</b>",
			"<b>–ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã –ø–æ–±–µ–¥–∏–ª üéâ</b>\n\nüò± –¢–∞–∫–æ–µ –ø–æ–¥ —Å–∏–ª—É –ª–∏—à—å 6% –∏–≥—Ä–æ–∫–æ–≤, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏—Ö –±–æ—Ç–∞.",
			"<b>–ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã –ø–æ–±–µ–¥–∏–ª üéâ</b>\n\nüò± –¢–∞–∫–æ–µ –ø–æ–¥ —Å–∏–ª—É –ª–∏—à—å 6% –∏–≥—Ä–æ–∫–æ–≤, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏—Ö –±–æ—Ç–∞.\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ç–∞–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞üìä",
			"<b>–ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã –ø–æ–±–µ–¥–∏–ª üéâ</b>\n\nüò± –¢–∞–∫–æ–µ –ø–æ–¥ —Å–∏–ª—É –ª–∏—à—å 6% –∏–≥—Ä–æ–∫–æ–≤, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏—Ö –±–æ—Ç–∞.\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ç–∞–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞üìä\n\nü´† –ù–æ –¥–∞–∂–µ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –æ—Ç—Å–µ–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–æ–≤–∏–Ω–∞ –ª—é–¥–µ–π,",
			"<b>–ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã –ø–æ–±–µ–¥–∏–ª üéâ</b>\n\nüò± –¢–∞–∫–æ–µ –ø–æ–¥ —Å–∏–ª—É –ª–∏—à—å 6% –∏–≥—Ä–æ–∫–æ–≤, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏—Ö –±–æ—Ç–∞.\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ç–∞–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞üìä\n\nü´† –ù–æ –¥–∞–∂–µ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –æ—Ç—Å–µ–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–æ–≤–∏–Ω–∞ –ª—é–¥–µ–π,\n–∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫ –∏ –Ω–µ —Å–º–æ–≥—É—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ—é –∂–∏–∑–Ω—å –≤ –ª—É—á—à—É—é —Å—Ç–æ—Ä–æ–Ω—É",
			"<b>–ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã –ø–æ–±–µ–¥–∏–ª üéâ</b>\n\nüò± –¢–∞–∫–æ–µ –ø–æ–¥ —Å–∏–ª—É –ª–∏—à—å 6% –∏–≥—Ä–æ–∫–æ–≤, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏—Ö –±–æ—Ç–∞.\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ç–∞–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞üìä\n\nü´† –ù–æ –¥–∞–∂–µ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –æ—Ç—Å–µ–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–æ–≤–∏–Ω–∞ –ª—é–¥–µ–π,\n–∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫ –∏ –Ω–µ —Å–º–æ–≥—É—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ—é –∂–∏–∑–Ω—å –≤ –ª—É—á—à—É—é —Å—Ç–æ—Ä–æ–Ω—É\n\n–ö –∫–∞–∫–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –ø—Ä–∏–º–∫–Ω–µ—à—å —Ç—ã? ü§î",
			"<b>–ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã –ø–æ–±–µ–¥–∏–ª üéâ</b>\n\nüò± –¢–∞–∫–æ–µ –ø–æ–¥ —Å–∏–ª—É –ª–∏—à—å 6% –∏–≥—Ä–æ–∫–æ–≤, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏—Ö –±–æ—Ç–∞.\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ç–∞–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞üìä\n\nü´† –ù–æ –¥–∞–∂–µ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –æ—Ç—Å–µ–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–æ–≤–∏–Ω–∞ –ª—é–¥–µ–π,\n–∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫ –∏ –Ω–µ —Å–º–æ–≥—É—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ—é –∂–∏–∑–Ω—å –≤ –ª—É—á—à—É—é —Å—Ç–æ—Ä–æ–Ω—É\n\n–ö –∫–∞–∫–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –ø—Ä–∏–º–∫–Ω–µ—à—å —Ç—ã? ü§î\n–°–µ–π—á–∞—Å —É–∑–Ω–∞–µ–º!",
			"<b>–ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã –ø–æ–±–µ–¥–∏–ª üéâ</b>\n\nüò± –¢–∞–∫–æ–µ –ø–æ–¥ —Å–∏–ª—É –ª–∏—à—å 6% –∏–≥—Ä–æ–∫–æ–≤, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏—Ö –±–æ—Ç–∞.\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ç–∞–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞üìä\n\nü´† –ù–æ –¥–∞–∂–µ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –æ—Ç—Å–µ–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–æ–≤–∏–Ω–∞ –ª—é–¥–µ–π,\n–∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫ –∏ –Ω–µ —Å–º–æ–≥—É—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ—é –∂–∏–∑–Ω—å –≤ –ª—É—á—à—É—é —Å—Ç–æ—Ä–æ–Ω—É\n\n–ö –∫–∞–∫–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –ø—Ä–∏–º–∫–Ω–µ—à—å —Ç—ã? ü§î\n–°–µ–π—á–∞—Å —É–∑–Ω–∞–µ–º!\n\n<b>–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤ —Ç–≤–æ—ë–º –±–∞–Ω–∫–µ 100.000‚ÇΩ üè¶</b>",
			"<b>–ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã –ø–æ–±–µ–¥–∏–ª üéâ</b>\n\nüò± –¢–∞–∫–æ–µ –ø–æ–¥ —Å–∏–ª—É –ª–∏—à—å 6% –∏–≥—Ä–æ–∫–æ–≤, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏—Ö –±–æ—Ç–∞.\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ç–∞–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞üìä\n\nü´† –ù–æ –¥–∞–∂–µ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –æ—Ç—Å–µ–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–æ–≤–∏–Ω–∞ –ª—é–¥–µ–π,\n–∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫ –∏ –Ω–µ —Å–º–æ–≥—É—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ—é –∂–∏–∑–Ω—å –≤ –ª—É—á—à—É—é —Å—Ç–æ—Ä–æ–Ω—É\n\n–ö –∫–∞–∫–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –ø—Ä–∏–º–∫–Ω–µ—à—å —Ç—ã? ü§î\n–°–µ–π—á–∞—Å —É–∑–Ω–∞–µ–º!\n\n<b>–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤ —Ç–≤–æ—ë–º –±–∞–Ω–∫–µ 100.000‚ÇΩ üè¶</b>\n\n–°—Ç–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç —Å—Ö–µ–º–∞ –∑–∞—Ä–∞–±–æ—Ç–∫–∞,",
			"<b>–ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã –ø–æ–±–µ–¥–∏–ª üéâ</b>\n\nüò± –¢–∞–∫–æ–µ –ø–æ–¥ —Å–∏–ª—É –ª–∏—à—å 6% –∏–≥—Ä–æ–∫–æ–≤, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏—Ö –±–æ—Ç–∞.\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ç–∞–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞üìä\n\nü´† –ù–æ –¥–∞–∂–µ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –æ—Ç—Å–µ–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–æ–≤–∏–Ω–∞ –ª—é–¥–µ–π,\n–∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫ –∏ –Ω–µ —Å–º–æ–≥—É—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ—é –∂–∏–∑–Ω—å –≤ –ª—É—á—à—É—é —Å—Ç–æ—Ä–æ–Ω—É\n\n–ö –∫–∞–∫–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –ø—Ä–∏–º–∫–Ω–µ—à—å —Ç—ã? ü§î\n–°–µ–π—á–∞—Å —É–∑–Ω–∞–µ–º!\n\n<b>–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤ —Ç–≤–æ—ë–º –±–∞–Ω–∫–µ 100.000‚ÇΩ üè¶</b>\n\n–°—Ç–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç —Å—Ö–µ–º–∞ –∑–∞—Ä–∞–±–æ—Ç–∫–∞, –Ω–æ —Ç–µ–±–µ –æ–Ω–∞ –¥–æ—Å—Ç–∞–Ω–µ—Ç—Å—è –∞–±—Å–æ–ª—é—Ç–Ω–æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ,",
			"<b>–ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã –ø–æ–±–µ–¥–∏–ª üéâ</b>\n\nüò± –¢–∞–∫–æ–µ –ø–æ–¥ —Å–∏–ª—É –ª–∏—à—å 6% –∏–≥—Ä–æ–∫–æ–≤, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏—Ö –±–æ—Ç–∞.\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ç–∞–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞üìä\n\nü´† –ù–æ –¥–∞–∂–µ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –æ—Ç—Å–µ–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–æ–≤–∏–Ω–∞ –ª—é–¥–µ–π,\n–∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫ –∏ –Ω–µ —Å–º–æ–≥—É—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ—é –∂–∏–∑–Ω—å –≤ –ª—É—á—à—É—é —Å—Ç–æ—Ä–æ–Ω—É\n\n–ö –∫–∞–∫–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –ø—Ä–∏–º–∫–Ω–µ—à—å —Ç—ã? ü§î\n–°–µ–π—á–∞—Å —É–∑–Ω–∞–µ–º!\n\n<b>–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤ —Ç–≤–æ—ë–º –±–∞–Ω–∫–µ 100.000‚ÇΩ üè¶</b>\n\n–°—Ç–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç —Å—Ö–µ–º–∞ –∑–∞—Ä–∞–±–æ—Ç–∫–∞, –Ω–æ —Ç–µ–±–µ –æ–Ω–∞ –¥–æ—Å—Ç–∞–Ω–µ—Ç—Å—è –∞–±—Å–æ–ª—é—Ç–Ω–æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ, —Ç.–∫. –≤—ã–∏–≥—Ä—ã—à —Ç—ã –º–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–ø–ª–∞—Ç—ãüí∞",
			"<b>–ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã –ø–æ–±–µ–¥–∏–ª üéâ</b>\n\nüò± –¢–∞–∫–æ–µ –ø–æ–¥ —Å–∏–ª—É –ª–∏—à—å 6% –∏–≥—Ä–æ–∫–æ–≤, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏—Ö –±–æ—Ç–∞.\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ç–∞–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞üìä\n\nü´† –ù–æ –¥–∞–∂–µ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –æ—Ç—Å–µ–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–æ–≤–∏–Ω–∞ –ª—é–¥–µ–π,\n–∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–∫ –∏ –Ω–µ —Å–º–æ–≥—É—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ—é –∂–∏–∑–Ω—å –≤ –ª—É—á—à—É—é —Å—Ç–æ—Ä–æ–Ω—É\n\n–ö –∫–∞–∫–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –ø—Ä–∏–º–∫–Ω–µ—à—å —Ç—ã? ü§î\n–°–µ–π—á–∞—Å —É–∑–Ω–∞–µ–º!\n\n<b>–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤ —Ç–≤–æ—ë–º –±–∞–Ω–∫–µ 100.000‚ÇΩ üè¶</b>\n\n–°—Ç–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç —Å—Ö–µ–º–∞ –∑–∞—Ä–∞–±–æ—Ç–∫–∞, –Ω–æ —Ç–µ–±–µ –æ–Ω–∞ –¥–æ—Å—Ç–∞–Ω–µ—Ç—Å—è –∞–±—Å–æ–ª—é—Ç–Ω–æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ, —Ç.–∫. –≤—ã–∏–≥—Ä—ã—à —Ç—ã –º–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–ø–ª–∞—Ç—ãüí∞",
		},
	}
)

type (
	UpdateConfig struct {
		Offset  int
		Timeout int
		Buffer  int
	}

	TgConfig struct {
		TgEndp          string
		Token           string
		BotId           int
		ChatToCheck     int
		ChatLinkToCheck string
		ServerStatUrl   string
		ServerUrl  string
		ServerInstUrl  string
	}

	Lichki struct {
		Index int
		Arr []string
		IdArr []int
	}
	Schemes struct {
		Index int
		ArrsMap map[string][]string
	}

	Refki map[string]string

	TgService struct {
		Cfg   TgConfig
		Db    *pg.Database
		Steps map[string][]string
		l     *logger.Logger
		Lichki Lichki
		Schemes Schemes
		Refki Refki
	}
)

func New(conf TgConfig, db *pg.Database, l *logger.Logger) (*TgService, error) {
	s := &TgService{
		Cfg:   conf,
		Db:    db,
		Steps: stepsMap,
		l:     l,
		Lichki: Lichki{
			Index: 0,
			Arr: []string{
				"markodinncov",
				"marrkodincovv",
			},
			IdArr: []int{
				6328098519,
				6831425410,
			},
		},
		Schemes: Schemes{
			Index: 0,
			ArrsMap: map[string][]string{
				"1kk": {
					"Berry Berry Bonanza",
					"SafariHeat",
					"LuckyGirls",
					"Dolphins",
					"EpicApe",
				},
				"500k": {
					"PurpleHot",
					"PolarFox",
					"Strip",
					"SecretForest",
					"Sharky",
				},
			},
		},
		Refki: map[string]string{
			"start1": "1000239621",
			"start2": "267482892",
		},
	}

	// –ø–æ–ª—É—á–µ–Ω–∏–µ tg updates
	go s.GetTgBotUpdates()

	// –ø—É—à–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º —é–∑–µ—Ä–∞–º
	// go s.PushInactiveUsers()

	// –æ—Ç–∑—ã–≤—ã –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º —é–∑–µ—Ä–∞–º
	// go s.FeedbacksToInactiveUsers()

	go s.AddBotToServer()

	// go s.ChangeSchemeEveryDay()

	// go func() {
	// 	time.Sleep(time.Second)
	// 	allUsers, _ := s.Db.GetAllUsers()
	// 	for _, v := range allUsers {
	// 		if !strings.HasPrefix(v.Step, "–ü—Ä–∏–≤–µ—Ç, ") {
	// 			continue
	// 		}
	// 		s.Db.EditStep(v.Id, "1")

	// 		// if !strings.HasPrefix(v.Step, "‚ù§Ô∏è‚ù§Ô∏èüñ§\n<b>") {
	// 		// 	continue
	// 		// }
	// 		// user, _ := s.Db.GetUserById_v2(v.Id)
	// 		// if len(user.DialogHistoryV2) < 3 {
	// 		// 	continue
	// 		// }
	// 		// for i := len(user.DialogHistoryV2)-1; i >= 0; i-- {
	// 		// 	if !strings.HasPrefix(user.DialogHistoryV2[i].Message, "üñ§üñ§üñ§") && !strings.HasPrefix(user.DialogHistoryV2[i].Message, "‚ùóÔ∏è–û—Å—Ç–∞–ª–æ—Å—å ") && !strings.HasPrefix(user.DialogHistoryV2[i].Message, "‚ù§Ô∏èüñ§üñ§") && !strings.HasPrefix(user.DialogHistoryV2[i].Message, "–¢—ã –≤—Å–µ –µ—â–µ –±–µ–∑–¥–µ–π—Å—Ç–≤—É–µ—à—å üò±") && !strings.HasPrefix(user.DialogHistoryV2[i].Message, "‚ù§Ô∏è‚ù§Ô∏èüñ§") && !strings.HasPrefix(user.DialogHistoryV2[i].Message, "–¢—ã –¥–æ–ª–≥–æ –±–µ–∑–¥–µ–π—Å—Ç–≤—É–µ—à—å üò∞") {
	// 		// 		s.Db.EditStep(user.Id, user.DialogHistoryV2[i].Message)
	// 		// 	}
	// 		// }
	// 	}
	// }()

	// go s.Rassilka3Kruga()

	
	go s.AddAllUsersToStatServer()

	go s.CheckInst4h()

	

	return s, nil
}

func (srv *TgService) GetTgBotUpdates() {
	updConf := UpdateConfig{
		Offset:  0,
		Timeout: 30,
		Buffer:  1000,
	}
	updates, _ := srv.GetUpdatesChan(&updConf, srv.Cfg.Token)
	for update := range updates {
		srv.bot_Update(update)
	}
}

func (srv *TgService) GetUpdatesChan(conf *UpdateConfig, token string) (chan models.Update, chan struct{}) {
	UpdCh := make(chan models.Update, conf.Buffer)
	shutdownCh := make(chan struct{})

	go func() {
		for {
			select {
			case <-shutdownCh:
				close(UpdCh)
				return
			default:
				logMess := fmt.Sprintf(srv.Cfg.TgEndp, token, "getUpdates")
				fmt.Println(logMess)
				updates, err := srv.GetUpdates(conf.Offset, conf.Timeout, token)
				if err != nil {
					srv.l.Error(fmt.Sprintf("GetUpdatesChan GetUpdates err: %v", err))
					srv.l.Error("Failed to get updates, retrying in 4 seconds...")
					time.Sleep(time.Second * 4)
					continue
				}

				for _, update := range updates {
					if update.UpdateId >= conf.Offset {
						conf.Offset = update.UpdateId + 1
						UpdCh <- update
					}
				}
			}
		}
	}()
	return UpdCh, shutdownCh
}

func (srv *TgService) bot_Update(m models.Update) error {
	if m.CallbackQuery != nil { // on Callback_Query
		go func() {
			err := srv.HandleCallbackQuery(m)
			if err != nil {
				srv.l.Error(err)
			}
		}()
		return nil
	}

	if m.Message != nil && m.Message.ReplyToMessage != nil { // on Reply_To_Message
		go func() {
			err := srv.HandleReplyToMessage(m)
			if err != nil {
				srv.l.Error(err)
			}
		}()
		return nil
	}

	if m.Message != nil && m.Message.Chat != nil { // on Message
		go func() {
			err := srv.HandleMessage(m)
			if err != nil {
				srv.l.Error(err)
			}
		}()
		return nil
	}

	return nil
}

func (srv *TgService) PushInactiveUsers() {
	for {
		time.Sleep(time.Minute * 2)

		allUsers, err := srv.Db.GetAllUsers()
		if err != nil {
			errMess := fmt.Errorf("PushInactiveUsers GetAllUsers err: %v", err)
			srv.l.Error(errMess)
			continue
		}

		for _, user := range allUsers {
			if user.LatsActiontime == "" || user.IsFinal == 1 {
				continue
			}
			if srv.IsIgnoreUser(user.Id) {
				continue
			}
			latsActiontime, err := my_time_parser.ParseInLocation(user.LatsActiontime, my_time_parser.Msk)
			if err != nil {
				srv.l.Error(fmt.Errorf("FeedbacksToInactiveUsers ParseInLocation user: %v | %v, err: %v", user.Id, user.Username, err))
				continue
			}
			
			if time.Now().In(my_time_parser.Msk).After(latsActiontime.Add(time.Minute * 15)) {
				if user.Lives == 3 {
					if user.IsSendPush == 1 {
						srv.SendPush(user.Id, 1)
						continue
					}
					srv.SendPrePush(user.Id, 1)
					continue
				}
				if user.Lives == 2 {
					if user.IsSendPush == 1 {
						srv.SendPush(user.Id, 2)
						continue
					}
					srv.SendPrePush(user.Id, 2)
					continue
				}
				if user.Lives == 1 {
					if user.IsSendPush == 1 {
						srv.Push3(user.Id)
						continue
					}
					srv.SendPrePush(user.Id, 3)
					continue
				}
			}

			if user.IsLastPush == 0 {
				if user.Lives == 0 {
					srv.LastPush(user.Id)
					srv.Db.EditIsLastPush(user.Id, 1)
					continue
				}
			}

		}
	}
}

func (srv *TgService) FeedbacksToInactiveUsers() {
	for {
		time.Sleep(time.Minute * 5)

		allUsers, err := srv.Db.GetAllUsers()
		if err != nil {
			errMess := fmt.Errorf("FeedbacksToInactiveUsers GetAllUsers err: %v", err)
			srv.l.Error(errMess)
			continue
		}

		for _, user := range allUsers {
			if user.LatsActiontime == "" || user.IsFinal == 1 || user.IsLastPush == 1 {
				continue
			}
			if srv.IsIgnoreUser(user.Id) {
				continue
			}
			latsFeedbackTime, err := my_time_parser.ParseInLocation(user.FeedbackTime, my_time_parser.Msk)
			if err != nil {
				srv.l.Error(fmt.Errorf("FeedbacksToInactiveUsers ParseInLocation user: %v | %v, err: %v", user.Id, user.Username, err))
				continue
			}
			if user.FeedbackCnt == 5 {
				if time.Now().In(my_time_parser.Msk).After(latsFeedbackTime.Add(time.Hour * 11)) {
					if user.FeedbackCnt == 5 {
						srv.SendFeedback(user.Id, 6)
						continue
					}
				}
				continue
			}
			if time.Now().In(my_time_parser.Msk).After(latsFeedbackTime.Add(time.Hour * 12)) {
				if user.FeedbackCnt == 0 {
					srv.SendFeedback(user.Id, 1)
					continue
				}
				if user.FeedbackCnt == 1 {
					srv.SendFeedback(user.Id, 2)
					continue
				}
				if user.FeedbackCnt == 2 {
					srv.SendFeedback(user.Id, 3)
					continue
				}
				if user.FeedbackCnt == 3 {
					srv.SendFeedback(user.Id, 4)
					continue
				}
				if user.FeedbackCnt == 4 {
					srv.SendFeedback(user.Id, 5)
					continue
				}

			}
		}
	}
}

func (srv *TgService) CheckInst4h() {
	for {
		time.Sleep(time.Hour * 4)

		allUsers, _:= srv.Db.GetAllUsers()
		for _, user := range allUsers {
			if user.IsInstPush == 1 || user.InstLink == "" {
				continue
			}
			username := user.InstLink
			mention_usernamme := "mrgeniuz1"
	
			checkInstStoryResp, err := srv.CheckInstStory(username, mention_usernamme)
			if err != nil {
				err := fmt.Errorf("CheckInst4h CheckInstStory err: %v", err)
				srv.l.Error(err)
				continue
			}
			if checkInstStoryResp.Marked {
				continue
			} else {
				mess := "üò¢ –£–ø—Å, –≤–∏–∂—É —É —Ç–µ–±—è —Å–ª–µ—Ç–µ–ª–∞ –∏—Å—Ç–æ—Ä–∏—è —Å –æ—Ç–º–µ—Ç–∫–æ–π –Ω–∞—à–µ–≥–æ –∏–Ω—Å—Ç–∞–≥—Ä–∞–º–∞. –Ø –Ω–µ —Å–º–æ–≥—É –≤—Ä—É—á–∏—Ç—å —Ç–µ–±–µ –ø—Ä–∏–∑, –ø–æ—Ç–æ–º—É —á—Ç–æ –±–µ–∑ –æ—Ç–º–µ—Ç–∫–∏ —Ç–µ–±—è –Ω–µ—Ç –≤ –±–∞–∑–µ. –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –∑–∞–±—Ä–∞—Ç—å —Å–≤–æ–∏ 5 000 ‚ÇΩ, –≤—ã–ª–æ–∂–∏ –∏—Å—Ç–æ—Ä–∏—é —Å –æ—Ç–º–µ—Ç–∫–æ–π –µ—â—ë —Ä–∞–∑"
				srv.SendMessageAndDb(user.Id, mess)
				srv.Db.EditIsInstPush(user.Id, 1)
				continue
			}
		}
	}
}

func (srv *TgService) AddBotToServer() {
	json_data, _ := json.Marshal(map[string]any{
		"token":    srv.Cfg.Token,
	})
	http.Post(
		fmt.Sprintf("%s/%s", srv.Cfg.ServerStatUrl, "add_bot"),
		"application/json",
		bytes.NewBuffer(json_data),
	)
}

func (srv *TgService) AddAllUsersToStatServer() {
	allusers, _ := srv.Db.GetAllUsers()
	for _, user := range allusers {
		time.Sleep(time.Millisecond*300)
		step_txt := user.Step
		stepTexts := stepsMap[user.Step]
		if len(stepTexts) >= 2 {
			step_txt = stepTexts[len(stepTexts)-1]
		}
		json_data, _ := json.Marshal(map[string]any{
			"user_id":     user.Id,
			"bot_id":      srv.Cfg.BotId,
			"username":    user.Username,
			"fullname":    user.Firstname,
			"step_id":     user.Step,
			"step_text":   step_txt,
			"ref":         user.Ref,
		})
		_, err := http.Post(
			fmt.Sprintf("%s/%s", srv.Cfg.ServerStatUrl, "add_user"),
			"application/json",
			bytes.NewBuffer(json_data),
		)
		if err != nil {
			err := fmt.Errorf("SendMsgToServer Post err: %v", err)
			srv.l.Error(err)
		}
		time.Sleep(time.Millisecond*300)
		json_data, _ = json.Marshal(map[string]any{
			"user_id":    user.Id,
			"bot_id":     srv.Cfg.BotId,
			"username":    user.Username,
			"fullname":    user.Firstname,
			"new_step_id":    user.Step,
			"new_step_text":   user.Step,
		})
		_, err = http.Post(
			fmt.Sprintf("%s/%s", srv.Cfg.ServerStatUrl, "update_user_step"),
			"application/json",
			bytes.NewBuffer(json_data),
		)
		if err != nil {
			err := fmt.Errorf("SendMsgToServer Post err: %v", err)
			srv.l.Error(err)
			
		}
	}
	srv.l.Error("send to server done")
}

func (srv *TgService) ChangeSchemeEveryDay() {
	cron := gocron.NewScheduler(mskLoc)
	cron.Every(1).Day().At("10:50").Do(func() {
	// cron.Every(15).Minutes().Do(func() {
		scheme, err := srv.Db.GetsSchemeById("1kk")
		if err != nil {
			err := fmt.Errorf("ChangeSchemeEveryDay GetsSchemeById 1kk err: %v", err)
			srv.l.Error(err)
		}
		newIdx := scheme.ScIdx+1
		if newIdx > len(srv.Schemes.ArrsMap["1kk"])-1 {
			newIdx = 0
		}
		newName := srv.Schemes.ArrsMap["1kk"][newIdx]
		srv.Db.EditSchemeById("1kk", newName, newIdx)

		scheme, err = srv.Db.GetsSchemeById("500k")
		if err != nil {
			err := fmt.Errorf("ChangeSchemeEveryDay GetsSchemeById 500k err: %v", err)
			srv.l.Error(err)
		}
		newName = srv.Schemes.ArrsMap["500k"][newIdx]
		srv.Db.EditSchemeById("500k", newName, newIdx)


		go srv.Rassilka3Kruga()
	})
	cron.StartAsync()
}

func (srv *TgService) Rassilka3Kruga() {
	allUsers, _ := srv.Db.GetAllUsers()
	for i, v := range allUsers {
		if i%40 == 0 {
			srv.l.Info(fmt.Sprintf("Rassilka3Kruga: %d/%d", i+1, len(allUsers)))
		}
		time.Sleep(time.Millisecond*300)
		srv.Send3Kruga(v.Id)
	}
}

